{"data":{"markdownRemark":{"html":"<h1 id=\"table-of-contents\"><a href=\"#table-of-contents\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Table of Contents</h1>\n<ol>\n<li><a href=\"#why-use-gatsby-for-an-e-commerce-site\">Why use Gatsby for an e-commerce site?</a></li>\n<li><a href=\"#prerequisites\">Prerequisites</a></li>\n<li><a href=\"#setting-up-a-gatsby-site\">Setting up a Gatsby site</a></li>\n<li><a href=\"#installing-stripe-checkout-plugin\">Installing Stripe Checkout plugin</a></li>\n<li><a href=\"#creating-a-button\">Creating a button</a></li>\n<li><a href=\"#importing-checkout-component-into-homepage\">Importing checkout component into homepage</a></li>\n<li><a href=\"#getting-your-stripe-test-keys\">Getting Your Stripe test keys</a></li>\n<li><a href=\"#configuring-stripe-in-gatsby\">Configuring Stripe in Gatsby</a></li>\n<li><a href=\"#setting-up-a-serverless-function-in-aws-lambda\">Setting up a serverless function in AWS Lambda</a></li>\n<li><a href=\"#setting-up-a-separate-repo\">Setting up a separate repo</a></li>\n<li><a href=\"#editing-your-new-repo\">Editing your new repo</a></li>\n<li><a href=\"#pushing-code-to-aws\">Pushing code to AWS</a></li>\n<li><a href=\"#configuring-serverless-with-your-aws-credentials\">Configuring serverless with your AWS credentials</a></li>\n<li><a href=\"#testing-payments\">Testing Payments</a></li>\n</ol>\n<h1 id=\"why-use-gatsby-for-an-e-commerce-site\"><a href=\"#why-use-gatsby-for-an-e-commerce-site\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Why use Gatsby for an e-commerce site?</h1>\n<p>In this advanced tutorial, you’ll learn how to use Gatsby to build the UI for a basic e-commerce site that can accept payments, with Stripe as the backend for processing payments. Benefits of using Gatsby for e-commerce sites include the following:</p>\n<ul>\n<li>Security inherent in static sites</li>\n<li>Blazing fast performance when your pages are converted from React into static files</li>\n<li>Easy to host</li>\n</ul>\n<p>You can see the working demo hosted here: <a href=\"https://gatsby-ecommerce.netlify.com/\">https://gatsby-ecommerce.netlify.com/</a></p>\n<h1 id=\"prerequisites\"><a href=\"#prerequisites\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Prerequisites</h1>\n<ul>\n<li>Since this is a more advanced tutorial, building a site with Gatsby before will likely make this tutorial less time-consuming (<a href=\"/tutorial/\">see main tutorial here</a>)</li>\n<li>Stripe account: <a href=\"https://dashboard.stripe.com/register\">register for an account here</a></li>\n<li>AWS account (free tier that covers anywhere from several thousand to a million requests per month): <a href=\"https://aws.amazon.com/free/?sc_channel=PS&#x26;sc_campaign=acquisition_US&#x26;sc_publisher=google&#x26;sc_medium=cloud_computing_b&#x26;sc_content=aws_account_e_control_q32016&#x26;sc_detail=create%20an%20aws%20account&#x26;sc_category=cloud_computing&#x26;sc_segment=102882721242&#x26;sc_matchtype=e&#x26;sc_country=US&#x26;s_kwcid=AL!4422!3!102882721242!e!!g!!create%20an%20aws%20account&#x26;ef_id=Wd_k7wAAAVgVBk9m:20180604172833:s\">register for an account here</a></li>\n<li>Willingness to navigate around janky AWS UIs</li>\n</ul>\n<h2 id=\"how-does-gatsby-work-with-stripe-and-aws\"><a href=\"#how-does-gatsby-work-with-stripe-and-aws\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>How does Gatsby work with Stripe and AWS?</h2>\n<p>Stripe is a payment processing service that allows you to securely collect and process payment information from your customers. To try out Stripe for yourself, go to <a href=\"https://stripe.com/docs/quickstart\">Stripe’s Quick Start Guide</a>.</p>\n<p>There are alternatives to Stripe, like Square and Braintree, and their setup is very similar to Stripe.</p>\n<p>Stripe requires a server to process the information to make a charge, so you’ll need more than just static pages. Gatsby builds the pages for your front-end, but it won’t be able to handle the server logic that Stripe requires to process payments. That means you’ll need to set up a simple function that your Gatsby project can POST to in order to handle a payment.</p>\n<p>That function can be set up a number of different ways. To set up that function from scratch, you could:</p>\n<ul>\n<li>Write your own simple server and deploy it somewhere, making it accessible via an endpoint</li>\n<li>Write and deploy a hosted serverless function through a service like AWS Lambda or Google Cloud</li>\n</ul>\n<h1 id=\"setting-up-a-gatsby-site\"><a href=\"#setting-up-a-gatsby-site\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Setting up a Gatsby site</h1>\n<p>Create a new Gatsby project by running the <code class=\"language-text\">gatsby new</code> command in the terminal and change directories into the new project you just started:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\">\n      <pre class=\"language-shell\"><code class=\"language-shell\">gatsby new ecommerce-gatsby-tutorial\n<span class=\"token function\">cd</span> ecommerce-gatsby-tutorial</code></pre>\n      </div>\n<h1 id=\"installing-stripe-checkout-plugin\"><a href=\"#installing-stripe-checkout-plugin\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Installing Stripe Checkout plugin</h1>\n<p>You can extend the functionality of this default starter with plugins. One such plugin is <code class=\"language-text\">gatsby-plugin-stripe-checkout</code>, which you’ll install in this project:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\">\n      <pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> gatsby-plugin-stripe-checkout</code></pre>\n      </div>\n<p>Open the root site directory in a text editor and navigate to <code class=\"language-text\">gatsby-config.js</code> and add the Stripe Checkout plugin to <code class=\"language-text\">gatsby-config.js</code> in the plugins section. Your <code class=\"language-text\">gatsby-config.js</code> should look like the following code example:</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\">\n      <pre class=\"language-jsx\"><code class=\"language-jsx\">module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  siteMetadata<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    title<span class=\"token punctuation\">:</span> <span class=\"token string\">\"Gatsby Default Starter\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  plugins<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"gatsby-plugin-react-helmet\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"gatsby-plugin-stripe-checkout\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span></code></pre>\n      </div>\n<h2 id=\"see-your-site-hot-reload-in-the-browser\"><a href=\"#see-your-site-hot-reload-in-the-browser\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>See your site hot reload in the browser!</h2>\n<p>Run <code class=\"language-text\">gatsby develop</code> in the terminal, which starts a development server and reloads changes you make to your site so you can preview them in the browser. Open up your browser to <a href=\"http://localhost8000.com/\">localhost:8000</a> and you should see a default homepage.</p>\n<blockquote>\n<p><strong>NOTE</strong>: If you have already started your gatsby development server using <code class=\"language-text\">gatsby develop</code>, you will need to restart the server by pressing CTRL + C in the terminal where the command was run and running <code class=\"language-text\">gatsby develop</code> again to see changes in your <code class=\"language-text\">gatsby-config.js</code> reflected on <a href=\"http://localhost8000.com/\">localhost:8000</a></p>\n</blockquote>\n<h2 id=\"how-does-the-stripe-checkout-plugin-work\"><a href=\"#how-does-the-stripe-checkout-plugin-work\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>How does the Stripe Checkout plugin work?</h2>\n<p>Stripe Checkout processes payments with information we send it, you can read more about how it works in Stripe’s docs. The Gatsby plugin, <code class=\"language-text\">gatsby-plugin-stripe-checkout</code>, will add this snippet:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\">\n      <pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token operator\">&lt;</span>script src<span class=\"token operator\">=</span><span class=\"token string\">\"https://checkout.stripe.com/checkout.js\"</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>/script<span class=\"token operator\">></span></code></pre>\n      </div>\n<p>to the end of the <code class=\"language-text\">&lt;body&gt;</code> tag across all of your pages in your Gatsby project, allowing you to call the Stripe checkout methods from Stripe’s API to create charges.</p>\n<p>If you want to further customise the checkout process or pull Stripe data into your site, check out <a href=\"https://www.gatsbyjs.org/plugins/?=stripe\">Gatsby’s plugin library for more Stripe plugins</a>.</p>\n<h1 id=\"creating-a-button\"><a href=\"#creating-a-button\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Creating a button</h1>\n<h2 id=\"sequence-of-events\"><a href=\"#sequence-of-events\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Sequence of events</h2>\n<p><code class=\"language-text\">configure()</code> sets up Stripe and automatically runs every time the page loads. Then you run <code class=\"language-text\">open()</code> when the buy button is clicked, which then triggers the Stripe payment overlay to open.</p>\n<p>Essentially, this is the sequence of events:</p>\n<ul>\n<li><em>page load</em> -> <code class=\"language-text\">configure()</code></li>\n<li><em>some time passes…</em></li>\n<li><em>user clicks button</em> -> <code class=\"language-text\">open()</code></li>\n</ul>\n<p>The next paragraphs describe how to setup these events.</p>\n<p>There is a default checkout modal that is available through the plugin we’re using, shown in the image below. When we call the <code class=\"language-text\">.open()</code> method through Stripe Checkout, the rest of the screen is darkened and a modal appears over the top, directing the user’s attention to the checkout form. You’ll need to create a button component that calls this method or triggers Stripe from your site.</p>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/card-payments-modal-ebf2b1273bdb48a80f72ece2891841e7-caaac.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; ; max-width: 600px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 90.49999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAAsTAAALEwEAmpwYAAADVUlEQVQ4y31US28bVRidf1DxY9ggscyiUcgL19ge2+Px24ntpOIhITbsQu2o4idQsWp3bBCpVChQsUgiJFKKQluJxk78dmZsj2dqt+VwzzedhLLA0tG9/h5H53vc0VKpFAzDEAT3SCRygXA4jGL5IxSrnyD8QfjCHo1G3shJpXwOLTAGjkwmgxs3aqjv7qJWq6O2exOPv63j+HZG/d9Brb6LusLOzhcSe5Fv+ByamTKhR3UkEgnBxsYGzlodDM9t9AfnsEYTTI5uwv7lc1jWCP2hhYHCX88aKKlY5qQUh6EU6skoNLIm4gkkk0nE43EUCgWcNJro9gZotbt49Mcxjo5P8JvC0cNHYqPvpHEqscwJqosbOjTKJrLZrDio8NlJE51uH2cq+c/HT7G/f4DDg0N1fyI2+hjDWOZksz4HoeVyORD5fB7pdBqVSkVUsLyhKs22x+q0/3W3xMeYSqUqJFSazysUitBKpRJ8bAjp9vY2zlX/XPc5JpMpxmNHTse5hOfNJKZarSoRGZVXRC6bRs6MQVtbW0MoFMLy8jIWFxeV/BxspWAy9TAYDNFut9HpdNDr9QTTqQPgb1FKwowq11x6G/F3rii8BW11dRUrKyt4b2kJCwsLME1TSnMUoW2P3oRlwxq7GDszWIFC9k6/ilToXZjRVWixWEwGUi6XUSwWVcnXpZxzVWZXKaK6brcr935/gGazgVarjZFaJ1HIHpbKMMwcEoZ5udhUFuwhCSfSQwfz+Rz8PX/xEvZoDLxS/1+9kD3d3NyUdUunTXkphEZDsNTRaFQm5g/FL5lKRuPJ6+E4aigeXBmKJbHMYS73kefFHnLCLH1ra0sIHcfF6WkLjcaZnAP1alzVV058qk4SMpYrxy1hu8ihccL8AHD8JOZukfDlbIa558FzXYE79c+554ovWBvDSEq7KIYqNZLpMV3Y6WBQrz/EZz92EfmmiY+/b+PDe218er8td9roYwxjdV0XXFPC1tff96fM2mlMqH5ysV13hjvHHr48GOHWQwdfHTn4+nd1qjtt9LGPLJn58o71uK+Qygj2wn9GRezt3cXhg/v49cEPOPjZx/5P/kkbfXvf3UVB9Y2lBk9XekjDfz8Q7OvK2vr/InQt9PrDcJlP/APtiesyWzyzxQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #ffffff;\"\n        alt=\"Stripe card payments modal\"\n        title=\"\"\n        src=\"/static/card-payments-modal-ebf2b1273bdb48a80f72ece2891841e7-caaac.png\"\n        srcset=\"/static/card-payments-modal-ebf2b1273bdb48a80f72ece2891841e7-42dcb.png 197w,\n/static/card-payments-modal-ebf2b1273bdb48a80f72ece2891841e7-7e5bf.png 393w,\n/static/card-payments-modal-ebf2b1273bdb48a80f72ece2891841e7-caaac.png 600w\"\n        sizes=\"(max-width: 600px) 100vw, 600px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<blockquote>\n<p>Notice the input fields for email and credit card information—this design is already made by Stripe for you to use without styling anything.</p>\n</blockquote>\n<p>In order to launch the Stripe Checkout modal (shown above), you need to call the <code class=\"language-text\">.configure()</code> method from Stripe Checkout in your Gatsby site. The only information you are required to provide is your publishable API key so that Stripe knows what account on their platform to send payments to. You can read about other recommended and optional configurations like currency or shipping information in the Stripe Checkout Reference. You are going to make a <code class=\"language-text\">checkout.js</code> file that handles this configuration.</p>\n<p>Create a new file at <code class=\"language-text\">src/components/checkout.js</code>. Your <code class=\"language-text\">checkout.js</code> file should look like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\">\n      <pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span>\n\n<span class=\"token comment\">// hardcoded amount (in US cents) to charge users</span>\n<span class=\"token comment\">// you could set this variable dynamically to charge different amounts</span>\n<span class=\"token keyword\">const</span> amount <span class=\"token operator\">=</span> <span class=\"token number\">2500</span>\n<span class=\"token keyword\">const</span> cardStyles <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  display<span class=\"token punctuation\">:</span> <span class=\"token string\">\"flex\"</span><span class=\"token punctuation\">,</span>\n  flexDirection<span class=\"token punctuation\">:</span> <span class=\"token string\">\"column\"</span><span class=\"token punctuation\">,</span>\n  justifyContent<span class=\"token punctuation\">:</span> <span class=\"token string\">\"space-around\"</span><span class=\"token punctuation\">,</span>\n  alignItems<span class=\"token punctuation\">:</span> <span class=\"token string\">\"flex-start\"</span><span class=\"token punctuation\">,</span>\n  padding<span class=\"token punctuation\">:</span> <span class=\"token string\">\"3rem\"</span><span class=\"token punctuation\">,</span>\n  boxShadow<span class=\"token punctuation\">:</span> <span class=\"token string\">\"5px 5px 25px 0 rgba(46,61,73,.2)\"</span><span class=\"token punctuation\">,</span>\n  backgroundColor<span class=\"token punctuation\">:</span> <span class=\"token string\">\"#fff\"</span><span class=\"token punctuation\">,</span>\n  borderRadius<span class=\"token punctuation\">:</span> <span class=\"token string\">\"6px\"</span><span class=\"token punctuation\">,</span>\n  maxWidth<span class=\"token punctuation\">:</span> <span class=\"token string\">\"400px\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">const</span> buttonStyles <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  fontSize<span class=\"token punctuation\">:</span> <span class=\"token string\">\"13px\"</span><span class=\"token punctuation\">,</span>\n  textAlign<span class=\"token punctuation\">:</span> <span class=\"token string\">\"center\"</span><span class=\"token punctuation\">,</span>\n  color<span class=\"token punctuation\">:</span> <span class=\"token string\">\"#fff\"</span><span class=\"token punctuation\">,</span>\n  outline<span class=\"token punctuation\">:</span> <span class=\"token string\">\"none\"</span><span class=\"token punctuation\">,</span>\n  padding<span class=\"token punctuation\">:</span> <span class=\"token string\">\"12px 60px\"</span><span class=\"token punctuation\">,</span>\n  boxShadow<span class=\"token punctuation\">:</span> <span class=\"token string\">\"2px 5px 10px rgba(0,0,0,.1)\"</span><span class=\"token punctuation\">,</span>\n  backgroundColor<span class=\"token punctuation\">:</span> <span class=\"token string\">\"rgb(255, 178, 56)\"</span><span class=\"token punctuation\">,</span>\n  borderRadius<span class=\"token punctuation\">:</span> <span class=\"token string\">\"6px\"</span><span class=\"token punctuation\">,</span>\n  letterSpacing<span class=\"token punctuation\">:</span> <span class=\"token string\">\"1.5px\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// Below is where the checkout component is defined.</span>\n<span class=\"token comment\">// It has several functions, and some default state variables.</span>\n<span class=\"token keyword\">const</span> Checkout <span class=\"token operator\">=</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">extends</span> React<span class=\"token punctuation\">.</span>Component <span class=\"token punctuation\">{</span>\n  state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    disabled<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n    buttonText<span class=\"token punctuation\">:</span> <span class=\"token string\">\"BUY NOW\"</span><span class=\"token punctuation\">,</span>\n    paymentMessage<span class=\"token punctuation\">:</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">resetButton</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> disabled<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> buttonText<span class=\"token punctuation\">:</span> <span class=\"token string\">\"BUY NOW\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">componentDidMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>stripeHandler <span class=\"token operator\">=</span> StripeCheckout<span class=\"token punctuation\">.</span><span class=\"token function\">configure</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// You’ll need to add your own Stripe public key to the `checkout.js` file.</span>\n      <span class=\"token comment\">// key: 'pk_test_STRIPE_PUBLISHABLE_KEY',</span>\n      key<span class=\"token punctuation\">:</span> <span class=\"token string\">\"pk_test_kuhbxb0MMZsp6fj6aTNDnxUu\"</span><span class=\"token punctuation\">,</span>\n      closed<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">resetButton</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">openStripeCheckout</span><span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    event<span class=\"token punctuation\">.</span><span class=\"token function\">preventDefault</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> disabled<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span> buttonText<span class=\"token punctuation\">:</span> <span class=\"token string\">\"WAITING...\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>stripeHandler<span class=\"token punctuation\">.</span><span class=\"token function\">open</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      name<span class=\"token punctuation\">:</span> <span class=\"token string\">\"Demo Product\"</span><span class=\"token punctuation\">,</span>\n      amount<span class=\"token punctuation\">:</span> amount<span class=\"token punctuation\">,</span>\n      description<span class=\"token punctuation\">:</span> <span class=\"token string\">\"A product well worth your time\"</span><span class=\"token punctuation\">,</span>\n      token<span class=\"token punctuation\">:</span> token <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token string\">`AWS_LAMBDA_URL`</span></span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n          method<span class=\"token punctuation\">:</span> <span class=\"token string\">\"POST\"</span><span class=\"token punctuation\">,</span>\n          body<span class=\"token punctuation\">:</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n            token<span class=\"token punctuation\">,</span>\n            amount<span class=\"token punctuation\">,</span>\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n          headers<span class=\"token punctuation\">:</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Headers</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n            <span class=\"token string\">\"Content-Type\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"application/json\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span>res <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n            console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Transaction processed successfully\"</span><span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">resetButton</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> paymentMessage<span class=\"token punctuation\">:</span> <span class=\"token string\">\"Payment Successful!\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">return</span> res<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">.</span><span class=\"token keyword\">catch</span><span class=\"token punctuation\">(</span>error <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n            console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Error:\"</span><span class=\"token punctuation\">,</span> error<span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> paymentMessage<span class=\"token punctuation\">:</span> <span class=\"token string\">\"Payment Failed\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">style</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>cardStyles<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h4</span><span class=\"token punctuation\">></span></span>Spend your Money<span class=\"token operator\">!</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h4</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span>\n          Use any email<span class=\"token punctuation\">,</span> <span class=\"token number\">4242</span> <span class=\"token number\">4242</span> <span class=\"token number\">4242</span> <span class=\"token number\">4242</span> <span class=\"token keyword\">as</span> the credit card number<span class=\"token punctuation\">,</span> any <span class=\"token number\">3</span>\n          digit number<span class=\"token punctuation\">,</span> and any future date <span class=\"token keyword\">of</span> expiration<span class=\"token punctuation\">.</span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span>\n          <span class=\"token attr-name\">style</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>buttonStyles<span class=\"token punctuation\">}</span></span>\n          <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>event <span class=\"token operator\">=></span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">openStripeCheckout</span><span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span>\n          <span class=\"token attr-name\">disabled</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>disabled<span class=\"token punctuation\">}</span></span>\n        <span class=\"token punctuation\">></span></span>\n          <span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>buttonText<span class=\"token punctuation\">}</span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>paymentMessage<span class=\"token punctuation\">}</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> Checkout</code></pre>\n      </div>\n<h2 id=\"what-did-you-just-do\"><a href=\"#what-did-you-just-do\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>What did you just do?</h2>\n<p>You imported React, set a default price for your product, added some styles, and introduced some React functions. The <code class=\"language-text\">componentDidMount()</code> and <code class=\"language-text\">openStripeCheckout()</code> functions are most important for the Stripe functionality. The <code class=\"language-text\">componentDidMount()</code> function is a React lifecycle method that launches when the component is first mounted to the DOM, making it a good place to configure the Stripe Checkout handler. It looks like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\">\n      <pre class=\"language-js\"><code class=\"language-js\"> <span class=\"token function\">componentDidMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n   <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>stripeHandler <span class=\"token operator\">=</span> StripeCheckout<span class=\"token punctuation\">.</span><span class=\"token function\">configure</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n     key<span class=\"token punctuation\">:</span> <span class=\"token string\">'pk_test_kuhbxb0MMZsp6fj6aTNDnxUu'</span><span class=\"token punctuation\">,</span>\n     closed<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n       <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">resetButton</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n     <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n   <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n <span class=\"token punctuation\">}</span></code></pre>\n      </div>\n<p>This gives Stripe our key, and tells Stripe to call the Checkout component’s resetButton() method when the Stripe modal is closed.</p>\n<p>The <code class=\"language-text\">openStripeCheckout()</code> function gives additional information to Stripe as a user launches the checkout modal, and will send the information they input to our serverless function once we create it.</p>\n<p>The tags in the <code class=\"language-text\">render()</code> function define the structure of HTML elements that lay out how the component is structured.</p>\n<h1 id=\"importing-checkout-component-into-homepage\"><a href=\"#importing-checkout-component-into-homepage\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Importing checkout component into homepage</h1>\n<p>Now go to your <code class=\"language-text\">src/pages/index.js</code> file. This is your homepage that shows at the root URL. Import your new checkout component in the file underneath the other two imports and replace the tags inside the first <code class=\"language-text\">&lt;div&gt;</code> tag with a <code class=\"language-text\">&lt;Checkout /&gt;</code> tag. Your <code class=\"language-text\">index.js</code> file should now look like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\">\n      <pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span>\n<span class=\"token keyword\">import</span> Link <span class=\"token keyword\">from</span> <span class=\"token string\">'gatsby-link'</span>\n<span class=\"gatsby-highlight-code-line\"><span class=\"token keyword\">import</span> Checkout <span class=\"token keyword\">from</span> <span class=\"token string\">'../components/checkout'</span>\n</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">IndexPage</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\n<span class=\"gatsby-highlight-code-line\">   <span class=\"token operator\">&lt;</span>Checkout <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n</span> <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> IndexPage</code></pre>\n      </div>\n<p>If you go back to <a href=\"http://localhost8000.com/\">localhost:8000</a> in your browser and you have <code class=\"language-text\">gatsby develop</code> running, you should have a big, enticing button on a card where the filler text used to be.</p>\n<h1 id=\"getting-your-stripe-test-keys\"><a href=\"#getting-your-stripe-test-keys\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Getting your Stripe test keys</h1>\n<p>View your API credentials by logging into your Stripe account, and then going to Developers > API Keys.</p>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/stripe-public-test-key-d2b907c751c6433c99b90cd55096251c-caaac.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; ; max-width: 600px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 46.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABdElEQVQoz22SW26DMBRE2f8Gqv50A11JN9CftikJj0CAgLHxG0+vDYmUqBJHti/2MMN1dqwH/FY9TucrqgvDxGZoJeGshTUm4ayB9x5O9BvOp5rWBovUEFKBLwpsFsgOxQV52aFsxyTIpwFKMKhFQMsIh9ULgtMIq0XwdpsT646h985IcEGCX3mDKFp3LAmOTNBXFYx18GsgZyvcjtYO1q1EoHXYasamvdG1kAbZ97HFkSLX3USCHONcQ5pPWF/chbbDHpfxHeXlBUX7im56gzIDxGJTZKUtxdabw7wcSHBODmeybcyCleIhBHo24tx7BikbStCQq57W9J/JndKaxihMgj/FgZrygXNfbA4pMheKovgU2cXY+2hsAA13onNFjeFCJmY6lxVtT4IVOdy63I0cVxJlXKbOxU03Ym3eDz7WVIp7ZQuynP5fXg10bca9MVMidv2Z/+q3/TeyeP/yqkPRXBPHur9zeuKhdh7SOp6JRm78ASnqr05pQQE6AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #ffffff;\"\n        alt=\"Stripe public test key location in Stripe account\"\n        title=\"\"\n        src=\"/static/stripe-public-test-key-d2b907c751c6433c99b90cd55096251c-caaac.png\"\n        srcset=\"/static/stripe-public-test-key-d2b907c751c6433c99b90cd55096251c-42dcb.png 197w,\n/static/stripe-public-test-key-d2b907c751c6433c99b90cd55096251c-7e5bf.png 393w,\n/static/stripe-public-test-key-d2b907c751c6433c99b90cd55096251c-caaac.png 600w\"\n        sizes=\"(max-width: 600px) 100vw, 600px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>You have 2 keys in both test mode and production mode:</p>\n<ul>\n<li>a publishable key</li>\n<li>a secret key</li>\n</ul>\n<p>While testing, you can use the keys that begins with pk<em>test</em> and sk<em>test</em>. For production code, you will want to use the keys that don’t say test. As the names imply, your publishable key may be included in code that you share publicly (for example, in GitHub), whereas your secret key should not be shared with anyone or committed to any public repo. It’s important to restrict access to this secret key because anyone who has it could potentially read or send requests from your Stripe account and see information about charges or purchases or even refund customers.</p>\n<h1 id=\"configuring-stripe-in-gatsby\"><a href=\"#configuring-stripe-in-gatsby\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Configuring Stripe in Gatsby</h1>\n<p>Add your Stripe publishable key to <code class=\"language-text\">src/components/checkout.js</code>.</p>\n<p>Inside the <code class=\"language-text\">componentDidMount()</code> function, you are calling configure on <code class=\"language-text\">StripeCheckout</code>. Replace the text in the single quotes with your own public key. This tells Stripe to send any payments through to your account.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\">\n      <pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function\">componentDidMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n   <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>stripeHandler <span class=\"token operator\">=</span> StripeCheckout<span class=\"token punctuation\">.</span><span class=\"token function\">configure</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n     <span class=\"token comment\">// You’ll need to add your own Stripe public test key here.</span>\n     <span class=\"token comment\">// key: 'pk_test_YOUR_KEY_GOES_HERE',</span>\n     key<span class=\"token punctuation\">:</span> <span class=\"token string\">'pk_test_kuhbxb0MMZsp6fj6aTNDnxUu'</span><span class=\"token punctuation\">,</span>\n     closed<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n       <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">resetButton</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n     <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n   <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n <span class=\"token punctuation\">}</span></code></pre>\n      </div>\n<p>After you replace <code class=\"language-text\">pk_test_YOUR_KEY_HERE</code> with your actual pk_test key and save the change, your button should launch the Stripe Checkout modal and allow you to enter in payment information. You can try and submit a payment, but it will fail because you haven’t set up your serverless function yet. Your Gatsby site is almost ready!</p>\n<h1 id=\"setting-up-a-serverless-function-in-aws-lambda\"><a href=\"#setting-up-a-serverless-function-in-aws-lambda\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Setting up a Serverless Function in AWS Lambda</h1>\n<p>Lambda is a service offered through Amazon Web Services that allows you to run code that would normally run on a server without having to provision or manage servers. For a simple function like a Stripe charge, Lambda will suit your use case nicely. AWS offers many options for configurations; you are going to use the Serverless Framework to help you minimize the steps to deployment, and also allow you to deploy to other cloud providers if needed.</p>\n<blockquote>\n<p><strong>NOTE</strong>: You can follow an adaptation of these steps using this tutorial and Serverless’ docs as a reference if you want to deploy your serverless function to a different provider like Google Cloud or Azure.</p>\n</blockquote>\n<h1 id=\"setting-up-a-separate-repo\"><a href=\"#setting-up-a-separate-repo\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Setting up a separate repo</h1>\n<p>You’ll be setting up a separate repo for the code that you’ll deploy to Lambda. To look through the example repo, <a href=\"https://github.com/gillkyle/gatsby-stripe-serverless-backend\">inspect the code in GitHub</a>.</p>\n<p>Clone the code to a new location on your computer and then change directories into this new folder:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\">\n      <pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token variable\"><span class=\"token variable\">`</span><span class=\"token function\">git</span> clone https://github.com/gillkyle/gatsby-stripe-serverless-backend.git<span class=\"token variable\">`</span></span>\n<span class=\"token variable\"><span class=\"token variable\">`</span><span class=\"token function\">cd</span> gatsby-stripe-serverless-backend<span class=\"token variable\">`</span></span></code></pre>\n      </div>\n<p>Then you need to run <code class=\"language-text\">npm install</code> to install the dependencies in the <code class=\"language-text\">package.json</code> file, which in this case is just the Stripe library.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\">\n      <pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span></code></pre>\n      </div>\n<h2 id=\"what-did-you-just-do-1\"><a href=\"#what-did-you-just-do-1\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>What did you just do?</h2>\n<p>By running <code class=\"language-text\">npm install</code>, you’ve created a node_modules folder that you’ll upload to AWS along with your code to make a charge. All of the code in this file will be hosted online by Amazon, and you need to provide it with the libraries you utilize in your project. By making this repository separate from our Gatsby project, we can decouple it from our site making it easier to switch to a different cloud hosting provider, and greatly decreasing the size of the files we upload to Amazon’s servers.</p>\n<h1 id=\"editing-your-new-repo\"><a href=\"#editing-your-new-repo\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Editing your new repo</h1>\n<p>Open gatsby-stripe-serverless-backend in your code editor.</p>\n<ul>\n<li>Rename the <code class=\"language-text\">secrets.example.json</code> file to <code class=\"language-text\">secrets.json</code>.</li>\n<li>Replace the string that says “sk<em>test</em>STRIPE<em>SECRET</em>KEY” in <code class=\"language-text\">secrets.json</code> with your secret test key from your Stripe account, and keep the quotation marks around it (using the test keys allows orders to go through without needing real credit card details, which is useful for testing)</li>\n</ul>\n<p>Your secret key can be included here if you don’t upload this file to a version control system. The .gitignore file in the project includes a line that will tell any git commands you run in this folder not to keep track of your secrets file as long as it is named <code class=\"language-text\">secrets.json</code>.</p>\n<h2 id=\"how-does-the-code-work-in-this-site\"><a href=\"#how-does-the-code-work-in-this-site\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>How does the code work in this site?</h2>\n<p>You don’t need to change any code in the <code class=\"language-text\">checkout.js</code> (not to be confused with the <code class=\"language-text\">checkout.js</code> file we used to create our component in Gatsby), but go ahead and open it up to review what it’s doing.</p>\n<p>The beginning of the file looks like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\">\n      <pre class=\"language-text\"><code class=\"language-text\">const stripe = require(&quot;stripe&quot;)(process.env.STRIPE_SECRET_KEY);\n\nmodule.exports.handler = (event, context, callback) =&gt; {\n.\n.\n.</code></pre>\n      </div>\n<p>Stripe is being initialized here, this time with your secret key. You’ll notice it is referencing the variable <code class=\"language-text\">STRIPE_SECRET_KEY</code> from <code class=\"language-text\">process.env</code>, because after you upload your code to AWS, your environment variables like API keys are available in that manner.</p>\n<p>The next line exports <code class=\"language-text\">handler</code>, a function that will handle your checkout logic.</p>\n<p>The next snippet of code (shown below), pulls some of the information on the <code class=\"language-text\">event</code> object that this function receives and stores them in the variables <code class=\"language-text\">requestData</code>, <code class=\"language-text\">amount</code>, and <code class=\"language-text\">token</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\">\n      <pre class=\"language-text\"><code class=\"language-text\">// Pull out the amount and id for the charge from the POST\n console.log(event);\n const requestData = JSON.parse(event.body);\n console.log(requestData);\n const amount = requestData.amount;\n const token = requestData.token.id;</code></pre>\n      </div>\n<p>The next 2 lines are to comply with web browser security standards. Because our Gatsby site will be at a different url than the function that we are going to upload to AWS, we have to include these headers in our response to say it’s okay to communicate with different URLs on the internet.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\">\n      <pre class=\"language-text\"><code class=\"language-text\"> // Headers to prevent CORS issues\n const headers = {\n   &quot;Access-Control-Allow-Origin&quot;: &quot;*&quot;,\n   &quot;Access-Control-Allow-Headers&quot;: &quot;Content-Type&quot;\n };</code></pre>\n      </div>\n<p>The last section of code is where the actual Stripe charge is created, and then the information about whether that charge was successful or not is sent back as a response.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\">\n      <pre class=\"language-text\"><code class=\"language-text\">return stripe.charges\n   .create({\n     // Create Stripe charge with token\n     amount,\n     source: token,\n     currency: &quot;usd&quot;,\n     description: &quot;Serverless test Stripe charge&quot;\n   })\n   .then(charge =&gt; {\n     // Success response\n     console.log(charge);\n     const response = {\n       headers,\n       statusCode: 200,\n       body: JSON.stringify({\n         message: `Charge processed!`,\n         charge\n       })\n     };\n     callback(null, response);\n   })\n   .catch(err =&gt; {\n     // Error response\n     console.log(err);\n     const response = {\n       headers,\n       statusCode: 500,\n       body: JSON.stringify({\n         error: err.message\n       })\n     };\n     callback(null, response);\n   });</code></pre>\n      </div>\n<p>A few things happen with <code class=\"language-text\">stripe.charges.create()</code>: it takes an object as an argument that tells the amount to charge, the unique token made by stripe that hides all the credit card information from us, as well as other information like currency to provide more information about the transaction.</p>\n<p>If the charge was successful, the code continues into the <code class=\"language-text\">then</code> block and prepares a successful response. If something went wrong, an error response is made and then that response (whether successful or not) is returned in the callback.</p>\n<h1 id=\"pushing-code-to-aws\"><a href=\"#pushing-code-to-aws\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Pushing code to AWS</h1>\n<p>Now you need to push your code up to AWS so we can hook it up to your Gatsby site.</p>\n<p>Install the serverless framework globally on your computer with this command: <code class=\"language-text\">npm install -g serverless</code> (the -g stands for global and allows you to use serverless in other projects besides just this one)</p>\n<p>Serverless is a CLI tool that helps speed up the development of serverless functions and connects the dots between writing the code and making the necessary configurations on different hosting providers.</p>\n<p>You can read more about the configurations you’ll use in the <code class=\"language-text\">serverless.yml</code> file in the repo you just cloned or in the Serverless docs.</p>\n<h1 id=\"configuring-serverless-with-your-aws-credentials\"><a href=\"#configuring-serverless-with-your-aws-credentials\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Configuring serverless with your AWS credentials</h1>\n<p>Configure serverless with your AWS credentials so you can make updates on AWS through the serverless tools with this command:</p>\n<blockquote>\n<p><strong>NOTE</strong>: It’s helpful to edit this command somewhere other than the terminal as you replace the dummy keys with your real keys, or else it might run halfway through your editing process</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"shell\">\n      <pre class=\"language-shell\"><code class=\"language-shell\">serverless config credentials --provider aws --key AAAAAAAEXAMPLE --secret aaaaaaaa/BBBBBBB/CCCdddEXAMPLEKEY</code></pre>\n      </div>\n<p>Where <code class=\"language-text\">AAAAAAAEXAMPLE</code> is your key and <code class=\"language-text\">aaaaaaaa/BBBBBBB/CCCdddEXAMPLEKEY</code> your secret.</p>\n<blockquote>\n<p><strong>NOTE:</strong> If you have trouble finding your way around AWS to get your keys, you can follow the <a href=\"https://serverless.com/framework/docs/providers/aws/guide/credentials#creating-aws-access-keys\">steps from the Serverless AWS Credentials docs</a>.</p>\n</blockquote>\n<p>In the gatsby-stripe-serverless-backend project, run <code class=\"language-text\">serverless deploy</code> and your function will be packaged up and uploaded to AWS.</p>\n<p>The output of <code class=\"language-text\">serverless deploy</code> should look something like this in your terminal:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\">\n      <pre class=\"language-shell\"><code class=\"language-shell\">Serverless: Packaging service<span class=\"token punctuation\">..</span>.\nServerless: Excluding development dependencies<span class=\"token punctuation\">..</span>.\nServerless: Creating Stack<span class=\"token punctuation\">..</span>.\nServerless: Checking Stack create progress<span class=\"token punctuation\">..</span>.\n<span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span>.\nServerless: Stack create finished<span class=\"token punctuation\">..</span>.\nServerless: Uploading CloudFormation <span class=\"token function\">file</span> to S3<span class=\"token punctuation\">..</span>.\nServerless: Uploading artifacts<span class=\"token punctuation\">..</span>.\nServerless: Uploading <span class=\"token function\">service</span> .zip <span class=\"token function\">file</span> to S3 <span class=\"token punctuation\">(</span>143.3 KB<span class=\"token punctuation\">)</span><span class=\"token punctuation\">..</span>.\nServerless: Validating template<span class=\"token punctuation\">..</span>.\nServerless: Updating Stack<span class=\"token punctuation\">..</span>.\nServerless: Checking Stack update progress<span class=\"token punctuation\">..</span>.\n<span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span>.\nServerless: Stack update finished<span class=\"token punctuation\">..</span>.\nService Information\nservice: gatsby-serverless-stripe\nstage: dev\nregion: us-east-1\nstack: gatsby-serverless-stripe-dev\napi keys:\n  None\nendpoints:\n  POST - https://random-text.execute-api.aws-zone.amazonaws.com/dev/checkout\nfunctions:\n  checkout: gatsby-serverless-stripe-dev-checkout</code></pre>\n      </div>\n<p>Copy the URL after the “-” in the post endpoint section, and paste it into your ecommerce-gatsby-tutorial site in the src > components > checkout.js file where it says <code class=\"language-text\">AWS_LAMBDA_URL</code></p>\n<div class=\"gatsby-highlight\" data-language=\"js\">\n      <pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function\">openStripeCheckout</span><span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n   event<span class=\"token punctuation\">.</span><span class=\"token function\">preventDefault</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n   <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> disabled<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span> buttonText<span class=\"token punctuation\">:</span> <span class=\"token string\">'WAITING...'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n   <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>stripeHandler<span class=\"token punctuation\">.</span><span class=\"token function\">open</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n     name<span class=\"token punctuation\">:</span> <span class=\"token string\">'Demo Product'</span><span class=\"token punctuation\">,</span>\n     amount<span class=\"token punctuation\">:</span> amount<span class=\"token punctuation\">,</span>\n     description<span class=\"token punctuation\">:</span> <span class=\"token string\">'A product well worth your time'</span><span class=\"token punctuation\">,</span>\n     token<span class=\"token punctuation\">:</span> token <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">       <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token string\">`AWS_LAMBDA_URL`</span></span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n</span>         method<span class=\"token punctuation\">:</span> <span class=\"token string\">'POST'</span><span class=\"token punctuation\">,</span>\n         body<span class=\"token punctuation\">:</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n           token<span class=\"token punctuation\">,</span>\n           amount<span class=\"token punctuation\">,</span>\n         <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n         headers<span class=\"token punctuation\">:</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Headers</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n           <span class=\"token string\">'Content-Type'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'application/json'</span><span class=\"token punctuation\">,</span>\n         <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n       <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n         <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span>res <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n<span class=\"token punctuation\">.</span>\n<span class=\"token punctuation\">.</span>\n<span class=\"token punctuation\">.</span></code></pre>\n      </div>\n<p>Now you have all the pieces in place!</p>\n<h1 id=\"testing-payments\"><a href=\"#testing-payments\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Testing Payments</h1>\n<p>You can test that your function is working by using this test credit card number offered by Stripe specifically for testing: 4242 4242 4242 4242, with any future date of expiration, any email, and any 3 digit CVC code.</p>\n<p>Logs of the Stripe code can be viewed in the terminal. In your <code class=\"language-text\">gatsby-stripe-serverless-backend</code> project, run the command <code class=\"language-text\">serverless logs -f &lt;function-name&gt; -t</code> with the name of your function instead of <function-name>. If you didn’t change anything in the <code class=\"language-text\">serverless.yml</code> file your function should be called checkout, like so: <code class=\"language-text\">serverless logs -f checkout -t</code>.</p>","excerpt":"Table of Contents Why use Gatsby for an e-commerce site? Prerequisites Setting up a Gatsby site Installing Stripe Checkout plugin Creating a…","timeToRead":17,"fields":{"slug":"/docs/ecommerce-tutorial/","anchor":"ecommerce-tutorial"},"frontmatter":{"title":"Gatsby E-Commerce Tutorial"},"parent":{"__typename":"File","relativePath":"docs/ecommerce-tutorial/index.md"}}},"pageContext":{"slug":"/docs/ecommerce-tutorial/"}}