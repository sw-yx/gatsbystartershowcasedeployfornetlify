{"data":{"markdownRemark":{"html":"<blockquote>\n<p>This document is a work in progress. Have you upgraded your site and run into something that’s not covered here? <a href=\"https://github.com/gatsbyjs/gatsby/edit/master/docs/docs/migrating-from-v1-to-v2.md\">Add your changes on GitHub</a>!</p>\n</blockquote>\n<h2 id=\"introduction\"><a href=\"#introduction\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Introduction</h2>\n<p>This is a reference for upgrading your site from Gatsby v1 to Gatsby v2. While there’s a lot covered here, you probably won’t need to do everything for your site.</p>\n<h1 id=\"starting-a-new-project-with-gatsby-v2\"><a href=\"#starting-a-new-project-with-gatsby-v2\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Starting a new project with Gatsby v2</h1>\n<p>Before diving in to the upgrade guide, here’s a brief section on starting a new project with Gatsby v2 instead of upgrading an existing project.</p>\n<p><em>Start from scratch:</em> If you’re a <em>start from scratch</em> kind of person, you can install the Gatsby beta and React like this: <code class=\"language-text\">npm install gatsby@next react react-dom</code></p>\n<p><em>Tutorial:</em> If you’d like a step-by-step guide, <a href=\"/tutorial/\">follow the tutorial</a> to get started with Gatsby v2.</p>\n<p><em>Starters:</em> If you’d rather use one of the official starters, you’re in luck, there’s a v2 edition for each of them. Install your favourite one with the Gatsby CLI.</p>\n<p><code class=\"language-text\">gatsby-starter-default</code> with v2:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\">\n      <pre class=\"language-text\"><code class=\"language-text\">gatsby new my-default-project https://github.com/gatsbyjs/gatsby-starter-default#v2</code></pre>\n      </div>\n<p><code class=\"language-text\">gatsby-starter-hello-world</code> with v2:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\">\n      <pre class=\"language-text\"><code class=\"language-text\">gatsby new my-hello-world https://github.com/gatsbyjs/gatsby-starter-hello-world#v2</code></pre>\n      </div>\n<p><code class=\"language-text\">gatsby-starter-blog</code> with v2:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\">\n      <pre class=\"language-text\"><code class=\"language-text\">gatsby new my-blog https://github.com/gatsbyjs/gatsby-starter-blog#v2</code></pre>\n      </div>\n<p>Read on for a detailed guide on what’s new in version 2!</p>\n<h2 id=\"what-well-cover\"><a href=\"#what-well-cover\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>What we’ll cover</h2>\n<ul>\n<li><a href=\"#update-gatsby-version\">Update Gatsby version</a></li>\n<li><a href=\"#manually-install-react\">Manually install React</a></li>\n<li><a href=\"#manually-install-plugins-peer-dependencies\">Manually install plugins’ peer dependencies</a></li>\n<li><a href=\"#update-layout-component\">Update layout component</a></li>\n<li><a href=\"#import-link-from-gatsby\">Import Link from Gatsby</a></li>\n<li><a href=\"#import-graphql-from-gatsby\">Import graphql from Gatsby</a></li>\n<li><a href=\"#rename-boundactioncreators-to-actions\">Rename <code class=\"language-text\">boundActionCreators</code> to <code class=\"language-text\">actions</code></a></li>\n<li><a href=\"#rename-pathcontext-to-pagecontext\">Rename <code class=\"language-text\">pathContext</code> to <code class=\"language-text\">pageContext</code></a></li>\n<li><a href=\"#rename-responsive-image-queries\">Rename responsive image queries</a></li>\n<li><a href=\"#manually-specify-postcss-plugins\">Manually specify PostCSS plugins</a></li>\n<li><a href=\"#convert-to-either-pure-commonjs-or-pure-es6\">Convert to either pure CommonJS or pure ES6</a></li>\n<li><a href=\"#dont-query-nodes-by-id\">Don’t query nodes by ID</a></li>\n<li><a href=\"#remove-explicit-polyfills\">Remove explicit polyfills</a></li>\n<li><a href=\"#change-modifybabelrc-to-oncreatebabelconfig\">Change <code class=\"language-text\">modifyBabelrc</code> to <code class=\"language-text\">onCreateBabelConfig</code></a></li>\n<li><a href=\"#change-modifywebpackconfig-to-oncreatewebpackconfig\">Change <code class=\"language-text\">modifyWebpackConfig</code> to <code class=\"language-text\">onCreateWebpackConfig</code></a></li>\n<li><a href=\"#change-navigateto-to-push\">Change <code class=\"language-text\">navigateTo</code> to <code class=\"language-text\">push</code></a></li>\n<li><a href=\"#remove-inlined-css-in-htmljs\">Remove inlined CSS in <code class=\"language-text\">html.js</code></a></li>\n<li><a href=\"#only-allow-defined-keys-on-the-node-internal-object\">Only allow defined keys on node.internal object</a></li>\n<li><a href=\"#import-graphql-types-from-gatsbygraphql\">Import <code class=\"language-text\">graphql</code> types from <code class=\"language-text\">gatsby/graphql</code></a></li>\n<li><a href=\"#move-babel-configuration\">Move <code class=\"language-text\">Babel Configuration</code></a></li>\n<li><a href=\"#explicit-query-names-no-longer-required\">Explicit query names no longer required</a></li>\n<li><a href=\"#plugin-specific-changes\">Plugin specific changes</a></li>\n</ul>\n<p>You can start with a few of the most important steps - install Gatsby v2 dependencies and update your layout components.</p>\n<h2 id=\"update-gatsby-version\"><a href=\"#update-gatsby-version\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Update Gatsby version</h2>\n<p>Update your <code class=\"language-text\">package.json</code> to use the pre-release versions of Gatsby.</p>\n<p><code class=\"language-text\">package.json</code></p>\n<div class=\"gatsby-highlight\" data-language=\"json\">\n      <pre class=\"language-json\"><code class=\"language-json\"><span class=\"token property\">\"dependencies\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"gatsby\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"next\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"gatsby-image\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"next\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"gatsby-plugin-sharp\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"next\"</span>\n<span class=\"token punctuation\">}</span></code></pre>\n      </div>\n<blockquote>\n<p>Note: Gatsby v2 is in pre-release so you may encounter further breaking changes.</p>\n</blockquote>\n<h2 id=\"update-gatsby-related-packages\"><a href=\"#update-gatsby-related-packages\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Update Gatsby related packages</h2>\n<p>Update your <code class=\"language-text\">package.json</code> to use the pre-release versions of Gatsby related packages. Any package name that starts with <code class=\"language-text\">gatsby-</code> should be upgraded to use the <code class=\"language-text\">next</code> version. Note, this only applies to plugins managed in the gatsbyjs/gatsby repo. If you’re using community plugins, they might not be upgraded yet. Check their repo for the status. Many plugins won’t actually need upgraded so they very well might keep working. For example:</p>\n<p><code class=\"language-text\">package.json</code></p>\n<div class=\"gatsby-highlight\" data-language=\"json\">\n      <pre class=\"language-json\"><code class=\"language-json\"><span class=\"token property\">\"dependencies\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"gatsby-plugin-google-analytics\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"next\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"gatsby-plugin-netlify\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"next\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"gatsby-plugin-sass\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"next\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span></code></pre>\n      </div>\n<h2 id=\"manually-install-react\"><a href=\"#manually-install-react\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Manually install React</h2>\n<p>In v1, the <code class=\"language-text\">react</code> and <code class=\"language-text\">react-dom</code> packages were included as part of the <code class=\"language-text\">gatsby</code> package. They are now <code class=\"language-text\">peerDependencies</code> so you are required to install them into your project.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\">\n      <pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">npm</span> i react react-dom</code></pre>\n      </div>\n<h2 id=\"manually-install-plugins-peer-dependencies\"><a href=\"#manually-install-plugins-peer-dependencies\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Manually install plugins’ peer dependencies</h2>\n<p>Some plugins had dependencies that were also made peerDependencies. For example, if you use <a href=\"https://www.gatsbyjs.org/packages/gatsby-plugin-typography/\"><code class=\"language-text\">gatsby-plugin-typography</code></a>, you now need to install:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\">\n      <pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">npm</span> i typography react-typography</code></pre>\n      </div>\n<p>Search for the plugins that you use in the <a href=\"/plugins\">plugin library</a> and check their installation instructions for additional packages that now need installed.</p>\n<h2 id=\"update-layout-component\"><a href=\"#update-layout-component\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Update layout component</h2>\n<p>The special layout component (<code class=\"language-text\">src/layouts/index.js</code>) that Gatsby v1 used to wrap every page has been removed. If the layout of your site appears to be broken, this is most likely the reason why.</p>\n<p>To learn more about the considerations behind this removal, read the <a href=\"https://github.com/gatsbyjs/rfcs/blob/master/text/0002-remove-special-layout-components.md\">RFC for removing the special layout component</a>.</p>\n<p>The following is the recommended migration path:</p>\n<h3 id=\"1-convert-children-from-function-to-normal-prop-required\"><a href=\"#1-convert-children-from-function-to-normal-prop-required\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. Convert children from function to normal prop (required)</h3>\n<p>In v1, the <code class=\"language-text\">children</code> prop passed to layout was a function and needed to be executed. In v2, this is no longer the case.</p>\n<div class=\"gatsby-highlight\" data-language=\"diff\">\n      <pre class=\"language-diff\"><code class=\"language-diff\">import React from \"react\"\n\nexport default ({ children }) => (\n  &lt;div>\n<span class=\"token deleted\">-    {children()}</span>\n<span class=\"token inserted\">+    {children}</span>\n  &lt;/div>\n)</code></pre>\n      </div>\n<h3 id=\"2-move-code-classlanguage-textlayoutsindexjscode-to-code-classlanguage-textsrccomponentslayoutjscode-optional-but-recommended\"><a href=\"#2-move-code-classlanguage-textlayoutsindexjscode-to-code-classlanguage-textsrccomponentslayoutjscode-optional-but-recommended\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. Move <code class=\"language-text\">layouts/index.js</code> to <code class=\"language-text\">src/components/layout.js</code> (optional, but recommended)</h3>\n<div class=\"gatsby-highlight\" data-language=\"bash\">\n      <pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> <span class=\"token function\">mv</span> src/layouts/index.js src/components/layout.js</code></pre>\n      </div>\n<h3 id=\"3-import-and-wrap-pages-with-layout-component\"><a href=\"#3-import-and-wrap-pages-with-layout-component\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. Import and wrap pages with layout component</h3>\n<p>Adhering to normal React composition model, you import the layout component and use it to wrap the content of the page.</p>\n<p><code class=\"language-text\">src/pages/index.js</code></p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\">\n      <pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span>\n<span class=\"token keyword\">import</span> Layout <span class=\"token keyword\">from</span> <span class=\"token string\">\"../components/layout\"</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Layout</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span>Hello World<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>Layout</span><span class=\"token punctuation\">></span></span>\n<span class=\"token punctuation\">)</span></code></pre>\n      </div>\n<p>Repeat for every page and template that needs this layout.</p>\n<h3 id=\"4-change-query-to-use-code-classlanguage-textstaticquerycode\"><a href=\"#4-change-query-to-use-code-classlanguage-textstaticquerycode\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. Change query to use <code class=\"language-text\">StaticQuery</code></h3>\n<p>Since layout is no longer special, you now need to make use of v2’s <a href=\"/docs/static-query/\">StaticQuery feature</a>.</p>\n<p>Replacing a layout’s query with <code class=\"language-text\">StaticQuery</code>:</p>\n<p><code class=\"language-text\">layout.js</code></p>\n<div class=\"gatsby-highlight\" data-language=\"diff\">\n      <pre class=\"language-diff\"><code class=\"language-diff\">import React, { Fragment } from \"react\"\nimport Helmet from \"react-helmet\"\n<span class=\"token inserted\">+ import { StaticQuery, graphql } from \"gatsby\"</span>\n\n<span class=\"token deleted\">- export default ({ children, data }) => (</span>\n<span class=\"token deleted\">-   &lt;></span>\n<span class=\"token deleted\">-     &lt;Helmet titleTemplate={`%s | ${data.site.siteMetadata.title}`} defaultTitle={data.site.siteMetadata.title} /></span>\n<span class=\"token deleted\">-     &lt;div></span>\n<span class=\"token deleted\">-       {children()}</span>\n<span class=\"token deleted\">-     &lt;/div></span>\n<span class=\"token deleted\">-   &lt;/></span>\n<span class=\"token deleted\">- )</span>\n<span class=\"token deleted\">-</span>\n<span class=\"token deleted\">- export const query = graphql`</span>\n<span class=\"token deleted\">-   query LayoutQuery {</span>\n<span class=\"token deleted\">-     site {</span>\n<span class=\"token deleted\">-       siteMetadata {</span>\n<span class=\"token deleted\">-         title</span>\n<span class=\"token deleted\">-       }</span>\n<span class=\"token deleted\">-     }</span>\n<span class=\"token deleted\">-   }</span>\n<span class=\"token deleted\">- `</span>\n<span class=\"token inserted\">+ export default ({ children }) => (</span>\n<span class=\"token inserted\">+   &lt;StaticQuery</span>\n<span class=\"token inserted\">+     query={graphql`</span>\n<span class=\"token inserted\">+       query LayoutQuery {</span>\n<span class=\"token inserted\">+         site {</span>\n<span class=\"token inserted\">+           siteMetadata {</span>\n<span class=\"token inserted\">+             title</span>\n<span class=\"token inserted\">+           }</span>\n<span class=\"token inserted\">+         }</span>\n<span class=\"token inserted\">+       }</span>\n<span class=\"token inserted\">+     `}</span>\n<span class=\"token inserted\">+     render={data => (</span>\n<span class=\"token inserted\">+       &lt;></span>\n<span class=\"token inserted\">+         &lt;Helmet titleTemplate={`%s | ${data.site.siteMetadata.title}`} defaultTitle={data.site.siteMetadata.title} /></span>\n<span class=\"token inserted\">+         &lt;div></span>\n<span class=\"token inserted\">+           {children}</span>\n<span class=\"token inserted\">+         &lt;/div></span>\n<span class=\"token inserted\">+       &lt;/></span>\n<span class=\"token inserted\">+     )}</span>\n<span class=\"token inserted\">+   /></span>\n<span class=\"token inserted\">+ )</span></code></pre>\n      </div>\n<h3 id=\"5-pass-code-classlanguage-texthistorycode-code-classlanguage-textlocationcode-and-code-classlanguage-textmatchcode-props-to-layout\"><a href=\"#5-pass-code-classlanguage-texthistorycode-code-classlanguage-textlocationcode-and-code-classlanguage-textmatchcode-props-to-layout\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5. Pass <code class=\"language-text\">history</code>, <code class=\"language-text\">location</code>, and <code class=\"language-text\">match</code> props to layout</h3>\n<p>In v1, layout component had access to <code class=\"language-text\">history</code>, <code class=\"language-text\">location</code>, and <code class=\"language-text\">match</code> props. In v2, only pages have access to these props; pass them to your layout component as needed.</p>\n<p><code class=\"language-text\">layout.js</code></p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\">\n      <pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> children<span class=\"token punctuation\">,</span> location <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span>Path is <span class=\"token punctuation\">{</span>location<span class=\"token punctuation\">.</span>pathname<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token punctuation\">{</span>children<span class=\"token punctuation\">}</span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n<span class=\"token punctuation\">)</span></code></pre>\n      </div>\n<p><code class=\"language-text\">src/pages/index.js</code></p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\">\n      <pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span>\n<span class=\"token keyword\">import</span> Layout <span class=\"token keyword\">from</span> <span class=\"token string\">\"../components/layout.js\"</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> props <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Layout</span> <span class=\"token attr-name\">location</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>props<span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span>Hello World<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>Layout</span><span class=\"token punctuation\">></span></span>\n<span class=\"token punctuation\">)</span></code></pre>\n      </div>\n<h2 id=\"import-link-from-gatsby\"><a href=\"#import-link-from-gatsby\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Import Link from Gatsby</h2>\n<p>All components and utility functions from <code class=\"language-text\">gatsby-link</code> are now exported from <code class=\"language-text\">gatsby</code> package. Therefore you should import it directly from <code class=\"language-text\">gatsby</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"diff\">\n      <pre class=\"language-diff\"><code class=\"language-diff\">import React from \"react\"\n<span class=\"token deleted\">- import Link from \"gatsby-link\"</span>\n<span class=\"token inserted\">+ import { Link } from \"gatsby\"</span>\n\nexport default props => (\n  &lt;Link to=\"/\">Home&lt;/Link>\n)</code></pre>\n      </div>\n<p>Furthermore you can remove the package from the <code class=\"language-text\">package.json</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"diff\">\n      <pre class=\"language-diff\"><code class=\"language-diff\">\"dependencies\": {\n  \"gatsby\": \"next\",\n  \"gatsby-image\": \"next\",\n  \"gatsby-plugin-sharp\": \"next\",\n<span class=\"token deleted\">- \"gatsby-link\": \"^1.6.39\"</span>\n}</code></pre>\n      </div>\n<h2 id=\"import-graphql-from-gatsby\"><a href=\"#import-graphql-from-gatsby\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Import graphql from Gatsby</h2>\n<p>The <code class=\"language-text\">graphql</code> tag function that Gatsby v1 auto-supports is deprecated in v2. Gatsby will throw deprecation warning unless you explicitly import it from the <code class=\"language-text\">gatsby</code> package.</p>\n<div class=\"gatsby-highlight\" data-language=\"diff\">\n      <pre class=\"language-diff\"><code class=\"language-diff\">import React from \"react\"\n<span class=\"token inserted\">+ import { graphql } from \"gatsby\"</span>\n\nexport default ({ data }) => (\n  &lt;h1>{data.site.siteMetadata.title}&lt;/h1>\n)\n\nexport const query = graphql`\n  query HomeQuery {\n    site {\n      siteMetadata {\n        title\n      }\n    }\n  }\n`</code></pre>\n      </div>\n<h2 id=\"rename-code-classlanguage-textboundactioncreatorscode-to-code-classlanguage-textactionscode\"><a href=\"#rename-code-classlanguage-textboundactioncreatorscode-to-code-classlanguage-textactionscode\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Rename <code class=\"language-text\">boundActionCreators</code> to <code class=\"language-text\">actions</code></h2>\n<p><code class=\"language-text\">boundActionCreators</code> is deprecated in v2. You can continue using it, but it’s recommended that you rename it to <code class=\"language-text\">actions</code>.</p>\n<blockquote>\n<p>TODO: document new actions - see <a href=\"/docs/actions\">actions</a></p>\n</blockquote>\n<h2 id=\"rename-code-classlanguage-textpathcontextcode-to-code-classlanguage-textpagecontextcode\"><a href=\"#rename-code-classlanguage-textpathcontextcode-to-code-classlanguage-textpagecontextcode\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Rename <code class=\"language-text\">pathContext</code> to <code class=\"language-text\">pageContext</code></h2>\n<p>Similar to <code class=\"language-text\">boundActionCreators</code> above, <code class=\"language-text\">pathContext</code> is deprecated in favor of <code class=\"language-text\">pageContext</code>.</p>\n<h2 id=\"rename-responsive-image-queries\"><a href=\"#rename-responsive-image-queries\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Rename responsive image queries</h2>\n<p>The <code class=\"language-text\">sizes</code> and <code class=\"language-text\">resolutions</code> queries are deprecated in v2. These queries have been renamed to <code class=\"language-text\">fluid</code> and <code class=\"language-text\">fixed</code> to make them easier to understand. You can continue using the deprecated query names, but it’s recommended that you update them.</p>\n<p>Update image query and fragment names:</p>\n<div class=\"gatsby-highlight\" data-language=\"diff\">\n      <pre class=\"language-diff\"><code class=\"language-diff\">const Example = ({ data }) => {\n  &lt;div>\n<span class=\"token deleted\">-    &lt;Img sizes={data.foo.childImageSharp.sizes} /></span>\n<span class=\"token deleted\">-    &lt;Img resolutions={data.bar.childImageSharp.resolutions} /></span>\n<span class=\"token inserted\">+    &lt;Img fluid={data.foo.childImageSharp.fluid} /></span>\n<span class=\"token inserted\">+    &lt;Img fixed={data.bar.childImageSharp.fixed} /></span>\n  &lt;/div>\n}\n\nexport default Example\n\nexport const pageQuery = graphql`\n  query IndexQuery {\n    foo: file(relativePath: { regex: \"/foo.jpg/\" }) {\n      childImageSharp {\n<span class=\"token deleted\">-        sizes(maxWidth: 700) {</span>\n<span class=\"token deleted\">-          ...GatsbyImageSharpSizes_tracedSVG</span>\n<span class=\"token inserted\">+        fluid(maxWidth: 700) {</span>\n<span class=\"token inserted\">+          ...GatsbyImageSharpFluid_tracedSVG</span>\n        }\n      }\n    }\n    bar: file(relativePath: { regex: \"/bar.jpg/\" }) {\n      childImageSharp {\n<span class=\"token deleted\">-        resolutions(width: 500) {</span>\n<span class=\"token deleted\">-          ...GatsbyImageSharpResolutions_withWebp</span>\n<span class=\"token inserted\">+        fixed(width: 500) {</span>\n<span class=\"token inserted\">+          ...GatsbyImageSharpFixed_withWebp</span>\n        }\n      }\n    }\n  }\n`</code></pre>\n      </div>\n<p>Further examples can be found in the <a href=\"https://github.com/gatsbyjs/gatsby/tree/d0e29272ed7b009dae18d35d41a45e700cdcab0d/packages/gatsby-image\">Gatsby Image docs</a>.</p>\n<h2 id=\"manually-specify-postcss-plugins\"><a href=\"#manually-specify-postcss-plugins\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Manually specify PostCSS plugins</h2>\n<p>Gatsby v2 removed <code class=\"language-text\">postcss-cssnext</code> and <code class=\"language-text\">postcss-import</code> from the default PostCSS setup.</p>\n<p>To have the same configuration that you had in v1, you should use <a href=\"https://github.com/gatsbyjs/gatsby/tree/master/packages/gatsby-plugin-postcss\"><code class=\"language-text\">gatsby-plugin-postcss</code></a> and follow the recommended migration path below.</p>\n<h3 id=\"1-install-the-dependencies\"><a href=\"#1-install-the-dependencies\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. Install the dependencies</h3>\n<p><code class=\"language-text\">npm install --save gatsby-plugin-postcss postcss-import postcss-cssnext postcss-browser-reporter postcss-reporter</code></p>\n<p><strong>NOTE</strong>: <code class=\"language-text\">postcss-cssnext</code> is <a href=\"https://moox.io/blog/deprecating-cssnext/\">deprecated</a> and it is better to use <code class=\"language-text\">postcss-preset-env</code> now.</p>\n<h3 id=\"2-include-code-classlanguage-textgatsby-plugin-postcsscode-in-your-code-classlanguage-textgatsby-configjscode-file\"><a href=\"#2-include-code-classlanguage-textgatsby-plugin-postcsscode-in-your-code-classlanguage-textgatsby-configjscode-file\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. Include <code class=\"language-text\">gatsby-plugin-postcss</code> in your <code class=\"language-text\">gatsby-config.js</code> file</h3>\n<div class=\"gatsby-highlight\" data-language=\"js\">\n      <pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// in gatsby-config.js</span>\nplugins<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token template-string\"><span class=\"token string\">`gatsby-plugin-postcss`</span></span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span></code></pre>\n      </div>\n<h3 id=\"3-include-postcss-plugins-in-your-code-classlanguage-textpostcssconfigjscode-file\"><a href=\"#3-include-postcss-plugins-in-your-code-classlanguage-textpostcssconfigjscode-file\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. Include PostCSS plugins in your <code class=\"language-text\">postcss.config.js</code> file</h3>\n<div class=\"gatsby-highlight\" data-language=\"js\">\n      <pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// in postcss.config.js</span>\n<span class=\"token keyword\">const</span> postcssImport <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token string\">`postcss-import`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> postcssCssNext <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token string\">`postcss-cssnext`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> postcssBrowserReporter <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token string\">`postcss-browser-reporter`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> postcssReporter <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token string\">`postcss-reporter`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nmodule<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">exports</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  plugins<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token function\">postcssImport</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token function\">postcssCssNext</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token function\">postcssBrowserReporter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token function\">postcssReporter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre>\n      </div>\n<h2 id=\"convert-to-either-pure-commonjs-or-pure-es6\"><a href=\"#convert-to-either-pure-commonjs-or-pure-es6\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Convert to either pure CommonJS or pure ES6</h2>\n<p>Gatsby v2 uses babel 7 which is stricter about parsing files with mixed JS styles.</p>\n<p>ES6 Modules are ok:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\">\n      <pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// GOOD: ES modules syntax works</span>\n<span class=\"token keyword\">import</span> foo <span class=\"token keyword\">from</span> <span class=\"token string\">\"foo\"</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> foo</code></pre>\n      </div>\n<p>CommonJS is ok:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\">\n      <pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// GOOD: CommonJS syntax works</span>\n<span class=\"token keyword\">const</span> foo <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"foo\"</span><span class=\"token punctuation\">)</span>\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> foo</code></pre>\n      </div>\n<p>Mixing <code class=\"language-text\">requires</code> and <code class=\"language-text\">export</code> is not ok:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\">\n      <pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// BAD: Mixed ES and CommonJS module syntax will cause failures</span>\n<span class=\"token keyword\">const</span> foo <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"foo\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> foo</code></pre>\n      </div>\n<p>Mixing <code class=\"language-text\">import</code> and <code class=\"language-text\">module.exports</code> is not ok:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\">\n      <pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// BAD: Mixed ES and CommonJS module syntax will cause failures</span>\n<span class=\"token keyword\">import</span> foo <span class=\"token keyword\">from</span> <span class=\"token string\">\"foo\"</span>\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> foo</code></pre>\n      </div>\n<p>See <a href=\"/docs/babel\">Gatsby’s babel docs for more details</a>.</p>\n<h2 id=\"dont-query-nodes-by-id\"><a href=\"#dont-query-nodes-by-id\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Don’t query nodes by ID</h2>\n<p>Source and transformer plugins now use UUIDs for IDs. If you used glob or regex to query nodes by id then you’ll need to query something else.</p>\n<p>Here’s an example querying an image:</p>\n<div class=\"gatsby-highlight\" data-language=\"diff\">\n      <pre class=\"language-diff\"><code class=\"language-diff\">  query MyImageQuery {\n    allImageSharp(filter: {\n<span class=\"token deleted\">-     id: {regex: \"/default.jpg/\"}</span>\n<span class=\"token inserted\">+     fluid: {originalName: {regex: \"/default.jpg/\"}}</span>\n    }) {\n      edges {\n        node {\n          id\n          fluid(maxWidth: 660) {\n            src\n          }\n        }\n      }\n    }\n  }</code></pre>\n      </div>\n<p><a href=\"https://github.com/gatsbyjs/gatsby/pull/3807/files\">See the Pull Request that implemented this change</a></p>\n<h2 id=\"remove-explicit-polyfills\"><a href=\"#remove-explicit-polyfills\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Remove explicit polyfills</h2>\n<p>If your Gatsby v1 site included any polyfills, you can remove them. Gatsby v2 ships with babel 7 and is configured to automatically include polyfills for your code. See <a href=\"/docs/babel\">Gatsby’s babel docs for more details</a>.</p>\n<blockquote>\n<p>Note: This works for your own code, but is not yet implemented for code imported from <code class=\"language-text\">node_modules</code>. Track progress of this feature at <a href=\"https://github.com/gatsbyjs/gatsby/issues/3870\">bullet 5 of this issue</a>.</p>\n</blockquote>\n<h2 id=\"change-code-classlanguage-textmodifybabelrccode-to-code-classlanguage-textoncreatebabelconfigcode\"><a href=\"#change-code-classlanguage-textmodifybabelrccode-to-code-classlanguage-textoncreatebabelconfigcode\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Change <code class=\"language-text\">modifyBabelrc</code> to <code class=\"language-text\">onCreateBabelConfig</code></h2>\n<p><code class=\"language-text\">modifyBabelrc</code> was renamed to <a href=\"/docs/node-apis/#modifyBabelrc\"><code class=\"language-text\">onCreateBabelConfig</code></a> to bring it in line with the rest of Gatsby’s API names.</p>\n<p>Use <code class=\"language-text\">onCreateBabelConfig</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"diff\">\n      <pre class=\"language-diff\"><code class=\"language-diff\"><span class=\"token deleted\">- exports.modifyBabelrc = ({ babelrc }) => {</span>\n<span class=\"token deleted\">-   return {</span>\n<span class=\"token deleted\">-     ...babelrc,</span>\n<span class=\"token deleted\">-     plugins: babelrc.plugins.concat([`foo`]),</span>\n<span class=\"token deleted\">-   }</span>\n<span class=\"token inserted\">+ exports.onCreateBabelConfig = ({ actions }) => {</span>\n<span class=\"token inserted\">+   actions.setBabelPlugin({</span>\n<span class=\"token inserted\">+     name: `babel-plugin-foo`,</span>\n<span class=\"token inserted\">+   })</span>\n}</code></pre>\n      </div>\n<p>Note usage of the new <a href=\"/docs/actions/#setBabelPlugins\"><code class=\"language-text\">setBabelPlugin</code> action</a>.</p>\n<p>See <a href=\"/docs/babel\">Gatsby’s babel docs for more details</a> about configuring babel.</p>\n<h2 id=\"change-code-classlanguage-textmodifywebpackconfigcode-to-code-classlanguage-textoncreatewebpackconfigcode\"><a href=\"#change-code-classlanguage-textmodifywebpackconfigcode-to-code-classlanguage-textoncreatewebpackconfigcode\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Change <code class=\"language-text\">modifyWebpackConfig</code> to <code class=\"language-text\">onCreateWebpackConfig</code></h2>\n<p><code class=\"language-text\">modifyWebpackConfig</code> was renamed to <a href=\"/docs/node-apis/#onCreateWebpackConfig\"><code class=\"language-text\">onCreateWebpackConfig</code></a> to bring it in line with the rest of Gatsby’s API names.</p>\n<p>Use <code class=\"language-text\">onCreateWebpackConfig</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"diff\">\n      <pre class=\"language-diff\"><code class=\"language-diff\"><span class=\"token deleted\">- exports.modifyWebpackConfig = ({ config, stage }) => {</span>\n<span class=\"token inserted\">+ exports.onCreateWebpackConfig = ({ stage, actions }) => {</span>\n  switch (stage) {\n    case `build-javascript`:\n<span class=\"token deleted\">-       config.plugin(`Foo`, webpackFooPlugin, null)</span>\n<span class=\"token deleted\">-       break</span>\n<span class=\"token deleted\">-   }</span>\n<span class=\"token deleted\">-   return config</span>\n<span class=\"token inserted\">+       actions.setWebpackConfig({</span>\n<span class=\"token inserted\">+         plugins: [webpackFooPlugin],</span>\n<span class=\"token inserted\">+       })</span>\n<span class=\"token inserted\">+   }</span>\n}</code></pre>\n      </div>\n<p>Note usage of the new <a href=\"/docs/actions/#setWebpackConfig\"><code class=\"language-text\">setWebpackConfig</code> action</a>.</p>\n<p>See <a href=\"/docs/add-custom-webpack-config\">Gatsby’s webpack docs for more details</a> about configuring webpack.</p>\n<h2 id=\"change-code-classlanguage-textnavigatetocode-to-code-classlanguage-textpushcode\"><a href=\"#change-code-classlanguage-textnavigatetocode-to-code-classlanguage-textpushcode\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Change <code class=\"language-text\">navigateTo</code> to <code class=\"language-text\">push</code></h2>\n<p>The <code class=\"language-text\">navigateTo</code> method in <code class=\"language-text\">gatsby-link</code> was renamed to <code class=\"language-text\">push</code> so as to mirror the browser history function. We also\nadded support for using <code class=\"language-text\">replace</code> as well.</p>\n<p>In addition to the name change, <code class=\"language-text\">gatsby-link</code> is now directly exported from the <code class=\"language-text\">gatsby</code> package.</p>\n<div class=\"gatsby-highlight\" data-language=\"diff\">\n      <pre class=\"language-diff\"><code class=\"language-diff\">import React from \"react\"\n<span class=\"token deleted\">- import { navigateTo } from \"gatsby-link\"</span>\n<span class=\"token inserted\">+ import { push } from \"gatsby\"</span>\n\n// Don't use push with an onClick btw :-)\n// Generally just use the `&lt;Link>` component.\nexport default props => (\n<span class=\"token deleted\">-  &lt;div onClick={() => navigateTo(`/`)}>Click to go to home&lt;/div></span>\n<span class=\"token inserted\">+  &lt;div onClick={() => push(`/`)}>Click to go to home&lt;/div></span>\n)</code></pre>\n      </div>\n<h2 id=\"remove-inlined-css-in-code-classlanguage-texthtmljscode\"><a href=\"#remove-inlined-css-in-code-classlanguage-texthtmljscode\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Remove inlined CSS in <code class=\"language-text\">html.js</code></h2>\n<p>Gatsby v2 automatically inlines CSS. You can remove any custom CSS inlining from your custom <code class=\"language-text\">html.js</code>.</p>\n<p>See an example in <a href=\"https://github.com/gatsbyjs/gatsby/commit/765b679cbc222fd5f527690427ee431cca7ccd61#diff-637c76e3c059ed8efacedf6e30de2d61\">this PR that upgrades the <code class=\"language-text\">using-remark</code> site to Gatsby v2</a>.</p>\n<h2 id=\"only-allow-defined-keys-on-the-node-internal-object\"><a href=\"#only-allow-defined-keys-on-the-node-internal-object\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Only allow defined keys on the node internal object</h2>\n<p>The node internal object isn’t meant for adding node data. Those should be added to the top-level object. We\ndidn’t document this in v1 nor validate against it but are now for v2.</p>\n<h2 id=\"import-code-classlanguage-textgraphqlcode-types-from-code-classlanguage-textgatsbygraphqlcode\"><a href=\"#import-code-classlanguage-textgraphqlcode-types-from-code-classlanguage-textgatsbygraphqlcode\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Import <code class=\"language-text\">graphql</code> types from <code class=\"language-text\">gatsby/graphql</code></h2>\n<p>Import graphql types from <code class=\"language-text\">gatsby/graphql</code> to prevent <code class=\"language-text\">Schema must contain unique named types but contains multiple types named &quot;&lt;typename&gt;&quot;</code> errors. <code class=\"language-text\">gatsby/graphql</code> exports all builtin GraphQL types as well as <code class=\"language-text\">graphQLJSON</code> type.</p>\n<div class=\"gatsby-highlight\" data-language=\"diff\">\n      <pre class=\"language-diff\"><code class=\"language-diff\"><span class=\"token deleted\">-const { GraphQLString } = require(`graphql`)</span>\n<span class=\"token inserted\">+const { GraphQLString } = require(`gatsby/graphql`)</span></code></pre>\n      </div>\n<h2 id=\"move-babel-configuration\"><a href=\"#move-babel-configuration\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Move Babel Configuration</h2>\n<p>The latest version of Gatsby uses Babel 7, which introduced <a href=\"https://github.com/babel/babel/issues/6766\">a new behavior for configuration lookup / resolution</a>. In the case where a <em>.babelrc</em> file might have been used at the root of the project, like for configuring Jest, moving that Babel configuration into <em>jest.config.json</em> will avoid any conflicts.</p>\n<p><a href=\"https://github.com/facebook/jest/issues/1468#issuecomment-361260279\">This GitHub comment</a> documents the steps needed to do that.</p>\n<p>More information on Gatsby and Babel configuration available <a href=\"/docs/babel/#how-to-use-a-custom-babelrc-file\">here</a>.</p>\n<h2 id=\"explicit-query-names-no-longer-required\"><a href=\"#explicit-query-names-no-longer-required\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Explicit query names no longer required</h2>\n<p>Gatsby v2 doesn’t require explicit query names. You can skip them now:</p>\n<div class=\"gatsby-highlight\" data-language=\"diff\">\n      <pre class=\"language-diff\"><code class=\"language-diff\">export const query = graphql`\n<span class=\"token deleted\">-  query ThisIsExplicitQueryName($slug: String!) {</span>\n<span class=\"token inserted\">+  query($slug: String!) {</span>\n    markdownRemark(fields: { slug: { eq: $slug } }) {\n      html\n      frontmatter {\n        title\n      }\n    }\n  }</code></pre>\n      </div>\n<p>You can also skip the <code class=\"language-text\">query</code> keyword if you don’t use query variables:</p>\n<div class=\"gatsby-highlight\" data-language=\"diff\">\n      <pre class=\"language-diff\"><code class=\"language-diff\">export const query = graphql`\n<span class=\"token deleted\">-  query ThisIsAnotherExplicitQueryName {</span>\n<span class=\"token inserted\">+  {</span>\n    site {\n      siteMetadata {\n        title\n      }\n    }\n  }</code></pre>\n      </div>\n<p>This isn’t a breaking change. Queries with explicit names will continue to work as they did in v1.</p>\n<h2 id=\"plugin-specific-changes\"><a href=\"#plugin-specific-changes\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Plugin specific changes</h2>\n<p>Some plugins require additional changes before your site will compile.\nFor example, if you use <a href=\"https://www.gatsbyjs.org/packages/gatsby-plugin-typography/\"><code class=\"language-text\">gatsby-plugin-typography</code></a>, you now need to explicitly export <code class=\"language-text\">scale</code> and <code class=\"language-text\">rhythm</code> as named exports from your typography config module.</p>\n<p><code class=\"language-text\">src/utils/typography.js</code></p>\n<div class=\"gatsby-highlight\" data-language=\"diff\">\n      <pre class=\"language-diff\"><code class=\"language-diff\"><span class=\"token deleted\">- const typography = new Typography();</span>\n<span class=\"token deleted\">- export default typography;</span>\n\n<span class=\"token inserted\">+ const typography = new Typography();</span>\n<span class=\"token inserted\">+ const { rhythm, scale } = typography;</span>\n<span class=\"token inserted\">+ export { rhythm, scale, typography as default };</span></code></pre>\n      </div>\n<h3 id=\"createremotefilenode\"><a href=\"#createremotefilenode\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>createRemoteFileNode</h3>\n<p>The signature for using createRemoteFileNode changed in v2, it now expects a new parameter <code class=\"language-text\">createNodeId</code>.</p>\n<p><a href=\"https://github.com/gatsbyjs/gatsby/tree/master/packages/gatsby-source-filesystem#createremotefilenode\">See docs for <code class=\"language-text\">createRemoteFileNode</code></a></p>","excerpt":"This document is a work in progress. Have you upgraded your site and run into something that’s not covered here?  Add your changes on GitHub…","timeToRead":16,"fields":{"slug":"/docs/migrating-from-v1-to-v2/","anchor":"migrating-from-v1-to-v2"},"frontmatter":{"title":"Migrating from v1 to v2"},"parent":{"__typename":"File","relativePath":"docs/migrating-from-v1-to-v2.md"}}},"pageContext":{"slug":"/docs/migrating-from-v1-to-v2/"}}