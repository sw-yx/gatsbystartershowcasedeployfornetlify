{"data":{"markdownRemark":{"html":"<p>Gatsby provides a rich set of lifecycle APIs to hook into Gatsby’s bootstrap,\nbuild, and client runtime operations.</p>\n<p>Gatsby’s design principles include:</p>\n<ul>\n<li>Conventions > code but use low-level primitives to build conventions with\ncode.</li>\n<li>Extracting logic and configuration into <a href=\"/docs/plugins/\">plugins</a> should be\ntrivial and encouraged.</li>\n<li>Plugins are easy to open source and reuse. They’re just NPM packages.</li>\n</ul>\n<h1 id=\"high-level-overview\"><a href=\"#high-level-overview\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>High level Overview</h1>\n<h2 id=\"bootstrap-sequence\"><a href=\"#bootstrap-sequence\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Bootstrap sequence</h2>\n<p>During “bootstrap” gatsby:</p>\n<ul>\n<li>reads <code class=\"language-text\">gatsby-config.js</code> to load in your list of plugins</li>\n<li>initializes its cache (stored in <code class=\"language-text\">/.cache</code>)</li>\n<li>pulls in and preprocesses data (“source and transform nodes”) into a GraphQL schema</li>\n<li>\n<p>creates pages in memory</p>\n<ul>\n<li>from your <code class=\"language-text\">/pages</code> folder</li>\n<li>from your <code class=\"language-text\">gatsby-node.js</code> if you implement <code class=\"language-text\">createPages</code>/<code class=\"language-text\">createPagesStatefully</code> (e.g. templates)</li>\n<li>from any plugins that implement <code class=\"language-text\">createPages</code>/<code class=\"language-text\">createPagesStatefully</code></li>\n</ul>\n</li>\n<li>extracts, runs, and replaces graphql queries for pages and <code class=\"language-text\">StaticQuery</code>s</li>\n<li>writes out the pages to cache</li>\n</ul>\n<p>In development this is a running process powered by <a href=\"https://github.com/gatsbyjs/gatsby/blob/dd91b8dceb3b8a20820b15acae36529799217ae4/packages/gatsby/package.json#L128\">Webpack</a> and <a href=\"https://github.com/gatsbyjs/gatsby/blob/dd91b8dceb3b8a20820b15acae36529799217ae4/packages/gatsby/package.json#L104\"><code class=\"language-text\">react-hot-loader</code></a>, so changes to any files get re-run through the sequence again, with <a href=\"https://github.com/gatsbyjs/gatsby/blob/ffd8b2d691c995c760fe380769852bcdb26a2278/packages/gatsby/src/bootstrap/index.js#L141\">smart cache invalidation</a>. For example, <code class=\"language-text\">gatsby-source-filesystem</code> watches files for changes, and each change triggers re-running queries. Other plugins may also perform this service. Queries are also watched so if you modify a query your development app is hot reloaded.</p>\n<p>The core of the bootstrap process is the “api-runner”, which helps to execute APIs in sequence, with state managed in Redux. Gatsby exposes a number of lifecycle APIs which can either be implemented by you (or any of your configured plugins) in <code class=\"language-text\">gatsby-node.js</code>, <code class=\"language-text\">gatsby-browser.js</code> or <code class=\"language-text\">gatsby-ssr.js</code>.</p>\n<p>The sequence of the <strong>main</strong> bootstrap Node API lifecycles are:</p>\n<ul>\n<li><a href=\"https://www.gatsbyjs.org/docs/node-apis/#onPreBootstrap\">onPreBootstrap</a> e.g. implemented by <a href=\"https://github.com/gatsbyjs/gatsby/blob/master/packages/gatsby-plugin-typography/src/gatsby-node.js\"><code class=\"language-text\">gatsby-plugin-typography</code></a></li>\n<li>\n<p><a href=\"https://www.gatsbyjs.org/docs/node-apis/#sourceNodes\">sourceNodes</a> e.g. implemented by <a href=\"https://github.com/gatsbyjs/gatsby/blob/master/packages/gatsby-source-wikipedia/src/gatsby-node.js\"><code class=\"language-text\">gatsby-source-wikipedia</code></a></p>\n<ul>\n<li>within this <code class=\"language-text\">createNode</code> can be called multiple times, which then triggers <a href=\"https://www.gatsbyjs.org/docs/node-apis/#onCreateNode\">onCreateNode</a>.</li>\n</ul>\n</li>\n<li>(the first schema build happens here)</li>\n<li><a href=\"https://www.gatsbyjs.org/docs/node-apis/#resolvableExtensions\">resolvableExtensions</a> for filetype/language extensions eg <a href=\"https://github.com/gatsbyjs/gatsby/blob/master/packages/gatsby-plugin-typescript/src/gatsby-node.js\"><code class=\"language-text\">gatsby-plugin-typescript</code></a></li>\n<li>\n<p><a href=\"https://www.gatsbyjs.org/docs/node-apis/#createPages\">createPages</a> e.g. implemented by <a href=\"https://github.com/gatsbyjs/gatsby/blob/master/packages/gatsby/src/bootstrap/page-hot-reloader.js\"><code class=\"language-text\">page-hot-reloader</code></a></p>\n<ul>\n<li>within this <code class=\"language-text\">createPage</code> can be called any number of times, which then triggers <a href=\"https://www.gatsbyjs.org/docs/node-apis/#onCreatePage\">onCreatePage</a></li>\n</ul>\n</li>\n<li><a href=\"https://www.gatsbyjs.org/docs/node-apis/#onPreExtractQueries\">onPreExtractQueries</a> e.g. implemented by <a href=\"https://github.com/gatsbyjs/gatsby/blob/master/packages/gatsby-transformer-sharp/src/gatsby-node.js\"><code class=\"language-text\">gatsby-transformer-sharp</code></a> and <a href=\"https://github.com/gatsbyjs/gatsby/blob/master/packages/gatsby-source-contentful/src/gatsby-node.js\"><code class=\"language-text\">gatsby-source-contentful</code></a></li>\n<li>(schema update happens here)</li>\n<li><strong>extract queries from components</strong> where the <a href=\"https://github.com/gatsbyjs/gatsby/blob/master/packages/gatsby/src/internal-plugins/query-runner/query-compiler.js#L189\">queryCompiler</a> replaces page GraphQL queries and <code class=\"language-text\">StaticQueries</code></li>\n<li>The <a href=\"https://github.com/gatsbyjs/gatsby/blob/master/packages/gatsby/src/internal-plugins/query-runner/page-query-runner.js#L100\">queries are run</a>, and the <a href=\"https://github.com/gatsbyjs/gatsby/blob/master/packages/gatsby/src/internal-plugins/query-runner/pages-writer.js\">pages are written out</a></li>\n<li><a href=\"https://www.gatsbyjs.org/docs/node-apis/#onPostBootstrap\">onPostBoostrap</a> is called (but it is not often used)</li>\n</ul>\n<h2 id=\"build-sequence\"><a href=\"#build-sequence\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Build sequence</h2>\n<p>(to be written)</p>\n<h2 id=\"client-sequence\"><a href=\"#client-sequence\" aria-hidden=\"true\" class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Client sequence</h2>\n<p>(to be written)</p>\n<hr>\n<p>Please see the links along the left under “REFERENCE” for the full API documentation.</p>","excerpt":"Gatsby provides a rich set of lifecycle APIs to hook into Gatsby’s bootstrap,\nbuild, and client runtime operations. Gatsby’s design…","timeToRead":4,"fields":{"slug":"/docs/gatsby-lifecycle-apis/","anchor":"gatsby-lifecycle-apis"},"frontmatter":{"title":"Gatsby Lifecycle APIs"},"parent":{"__typename":"File","relativePath":"docs/gatsby-lifecycle-apis.md"}}},"pageContext":{"slug":"/docs/gatsby-lifecycle-apis/"}}